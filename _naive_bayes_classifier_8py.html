<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: NaiveBayesClassifier.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_naive_bayes_classifier_8py.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">NaiveBayesClassifier.py File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Optic disc and cup segmentation using Naive Bayes classifier.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a13d212ce0288627d6d49c13eddd08478" id="r_a13d212ce0288627d6d49c13eddd08478"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13d212ce0288627d6d49c13eddd08478">NaiveBayesClassifier.resize_image</a> (image, max_size=512)</td></tr>
<tr class="memdesc:a13d212ce0288627d6d49c13eddd08478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resize regular fundus image to reduce memory usage.  <br /></td></tr>
<tr class="memitem:a9a277730ef50880d2684d3ab72208de5" id="r_a9a277730ef50880d2684d3ab72208de5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a277730ef50880d2684d3ab72208de5">NaiveBayesClassifier.resize_mask</a> (mask, max_size=512)</td></tr>
<tr class="memdesc:a9a277730ef50880d2684d3ab72208de5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resize segmentation mask using nearest neighbor interpolation.  <br /></td></tr>
<tr class="memitem:a9ff8da211c17e9d511aed1aa949134f5" id="r_a9ff8da211c17e9d511aed1aa949134f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ff8da211c17e9d511aed1aa949134f5">NaiveBayesClassifier.remap_mask_labels</a> (mask)</td></tr>
<tr class="memdesc:a9ff8da211c17e9d511aed1aa949134f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remap mask pixel values to standardized label values.  <br /></td></tr>
<tr class="memitem:a73b75df90f92c0ad4944c62bbed4fa22" id="r_a73b75df90f92c0ad4944c62bbed4fa22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73b75df90f92c0ad4944c62bbed4fa22">NaiveBayesClassifier.extract_features_with_coords</a> (image, normalize_coords=True, use_both_colorspaces=True)</td></tr>
<tr class="memdesc:a73b75df90f92c0ad4944c62bbed4fa22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract color and spatial features from fundus image.  <br /></td></tr>
<tr class="memitem:a8c74781d16d48fbc93bdadc17dc2db3e" id="r_a8c74781d16d48fbc93bdadc17dc2db3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c74781d16d48fbc93bdadc17dc2db3e">NaiveBayesClassifier.train_naive_bayes_memory_efficient</a> (fundus_files, mask_files, use_both_colorspaces=True, batch_size=5, max_size=512)</td></tr>
<tr class="memdesc:a8c74781d16d48fbc93bdadc17dc2db3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train Naive Bayes classifier using batch processing and incremental learning.  <br /></td></tr>
<tr class="memitem:ac6cb2d89b90545261429180549c75224" id="r_ac6cb2d89b90545261429180549c75224"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6cb2d89b90545261429180549c75224">NaiveBayesClassifier.predict_segmentation</a> (clf, scaler, test_image, use_both_colorspaces=True)</td></tr>
<tr class="memdesc:ac6cb2d89b90545261429180549c75224"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict segmentation mask for a test image.  <br /></td></tr>
<tr class="memitem:a7d436fe514cad6330c5f014915b37f4e" id="r_a7d436fe514cad6330c5f014915b37f4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d436fe514cad6330c5f014915b37f4e">NaiveBayesClassifier.calculate_dice_coefficient</a> (pred, gt, label)</td></tr>
<tr class="memdesc:a7d436fe514cad6330c5f014915b37f4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Dice coefficient for a specific segmentation class.  <br /></td></tr>
<tr class="memitem:a9e87a92082946d6e7f1a377d04ceabbb" id="r_a9e87a92082946d6e7f1a377d04ceabbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e87a92082946d6e7f1a377d04ceabbb">NaiveBayesClassifier.calculate_iou</a> (pred, gt, label)</td></tr>
<tr class="memdesc:a9e87a92082946d6e7f1a377d04ceabbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Intersection over Union (IoU) for a specific segmentation class.  <br /></td></tr>
<tr class="memitem:a8080beb1a309c9244ea838e3019a657a" id="r_a8080beb1a309c9244ea838e3019a657a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8080beb1a309c9244ea838e3019a657a">NaiveBayesClassifier.evaluate_segmentation</a> (pred_mask, gt_mask)</td></tr>
<tr class="memdesc:a8080beb1a309c9244ea838e3019a657a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate segmentation performance using multiple metrics.  <br /></td></tr>
<tr class="memitem:afe82966cb6078dba455bdd207c50bac0" id="r_afe82966cb6078dba455bdd207c50bac0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe82966cb6078dba455bdd207c50bac0">NaiveBayesClassifier.save_metrics_as_image</a> (metrics_dict, image_name, save_path)</td></tr>
<tr class="memdesc:afe82966cb6078dba455bdd207c50bac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save evaluation metrics as a formatted table image.  <br /></td></tr>
<tr class="memitem:aa4876264353f0b3bf444e100b7467b62" id="r_aa4876264353f0b3bf444e100b7467b62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa4876264353f0b3bf444e100b7467b62">NaiveBayesClassifier.save_summary_metrics_as_image</a> (all_metrics, save_path)</td></tr>
<tr class="memdesc:aa4876264353f0b3bf444e100b7467b62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save overall summary metrics across all test images as a table image.  <br /></td></tr>
<tr class="memitem:a5afa48c6aec410b5355df43bab6e5ec8" id="r_a5afa48c6aec410b5355df43bab6e5ec8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5afa48c6aec410b5355df43bab6e5ec8">NaiveBayesClassifier.visualize_results</a> (original, predicted_mask, gt_mask=None, save_path=None)</td></tr>
<tr class="memdesc:a5afa48c6aec410b5355df43bab6e5ec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Visualize segmentation results with side-by-side comparison.  <br /></td></tr>
<tr class="memitem:acf9536d05f474b242e8d2078e7c75d95" id="r_acf9536d05f474b242e8d2078e7c75d95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf9536d05f474b242e8d2078e7c75d95">NaiveBayesClassifier.main</a> ()</td></tr>
<tr class="memdesc:acf9536d05f474b242e8d2078e7c75d95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory-efficient main execution pipeline for optic disc and cup segmentation.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Optic disc and cup segmentation using Naive Bayes classifier. </p>
<p>This module implements a memory-efficient pipeline for retinal image segmentation using a Gaussian Naive Bayes classifier with spatial and color features to segment optic disc, cup, and background regions from fundus images.</p>
<dl class="section author"><dt>Author</dt><dd>Rishab Ramesh Nair </dd></dl>
<dl class="section date"><dt>Date</dt><dd>September 23, 2025 </dd></dl>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a7d436fe514cad6330c5f014915b37f4e" name="a7d436fe514cad6330c5f014915b37f4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d436fe514cad6330c5f014915b37f4e">&#9670;&#160;</a></span>calculate_dice_coefficient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.calculate_dice_coefficient </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>label</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Dice coefficient for a specific segmentation class. </p>
<p>Computes the Dice similarity coefficient (F1 score) between predicted and ground truth segmentation for a single class label. The Dice coefficient is calculated as: 2 * |X ∩ Y| / (|X| + |Y|)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pred</td><td>Predicted segmentation mask. </td></tr>
    <tr><td class="paramname">gt</td><td>Ground truth segmentation mask. </td></tr>
    <tr><td class="paramname">label</td><td>Class label value to evaluate (0, 128, or 255).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Dice coefficient value in range [0, 1] where 1 indicates perfect overlap.</dd></dl>
<pre class="fragment">Calculate Dice coefficient for a specific class</pre> 
</div>
</div>
<a id="a9e87a92082946d6e7f1a377d04ceabbb" name="a9e87a92082946d6e7f1a377d04ceabbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e87a92082946d6e7f1a377d04ceabbb">&#9670;&#160;</a></span>calculate_iou()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.calculate_iou </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pred</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>label</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Intersection over Union (IoU) for a specific segmentation class. </p>
<p>Computes the IoU (Jaccard index) between predicted and ground truth segmentation for a single class label. IoU is calculated as: |X ∩ Y| / |X ∪ Y|</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pred</td><td>Predicted segmentation mask. </td></tr>
    <tr><td class="paramname">gt</td><td>Ground truth segmentation mask. </td></tr>
    <tr><td class="paramname">label</td><td>Class label value to evaluate (0, 128, or 255).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IoU value in range [0, 1] where 1 indicates perfect overlap.</dd></dl>
<pre class="fragment">Calculate Intersection over Union (IoU) for a specific class</pre> 
</div>
</div>
<a id="a8080beb1a309c9244ea838e3019a657a" name="a8080beb1a309c9244ea838e3019a657a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8080beb1a309c9244ea838e3019a657a">&#9670;&#160;</a></span>evaluate_segmentation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.evaluate_segmentation </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pred_mask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gt_mask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate segmentation performance using multiple metrics. </p>
<p>Computes comprehensive evaluation metrics including overall pixel accuracy, per-class Dice coefficients and IoU scores for all three classes (disc, cup, background), and their mean values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pred_mask</td><td>Predicted segmentation mask. </td></tr>
    <tr><td class="paramname">gt_mask</td><td>Ground truth segmentation mask.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Dictionary containing the following metrics:<ul>
<li>'accuracy': Overall pixel accuracy</li>
<li>'dice_disc': Dice coefficient for disc class (0)</li>
<li>'dice_cup': Dice coefficient for cup class (128)</li>
<li>'dice_background': Dice coefficient for background class (255)</li>
<li>'dice_mean': Mean Dice across all classes</li>
<li>'iou_disc': IoU for disc class (0)</li>
<li>'iou_cup': IoU for cup class (128)</li>
<li>'iou_background': IoU for background class (255)</li>
<li>'iou_mean': Mean IoU across all classes</li>
</ul>
</dd></dl>
<pre class="fragment">Evaluate segmentation performance</pre> 
</div>
</div>
<a id="a73b75df90f92c0ad4944c62bbed4fa22" name="a73b75df90f92c0ad4944c62bbed4fa22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73b75df90f92c0ad4944c62bbed4fa22">&#9670;&#160;</a></span>extract_features_with_coords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.extract_features_with_coords </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>normalize_coords</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>use_both_colorspaces</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract color and spatial features from fundus image. </p>
<p>Extracts pixel-wise features including RGB and optionally HSV color information along with normalized or absolute spatial coordinates for training or prediction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>Input fundus image (BGR format). </td></tr>
    <tr><td class="paramname">normalize_coords</td><td>If True, normalize coordinates to [0,1] range. Default is True. </td></tr>
    <tr><td class="paramname">use_both_colorspaces</td><td>If True, extract both RGB and HSV features. Default is True.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Feature array of shape (height*width, n_features) where n_features is 8 (RGB + HSV + x + y) if use_both_colorspaces=True, or 5 (RGB + x + y) if use_both_colorspaces=False.</dd></dl>
<pre class="fragment">Extract color and spatial features from fundus image</pre> 
</div>
</div>
<a id="acf9536d05f474b242e8d2078e7c75d95" name="acf9536d05f474b242e8d2078e7c75d95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf9536d05f474b242e8d2078e7c75d95">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.main </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory-efficient main execution pipeline for optic disc and cup segmentation. </p>
<p>Executes the complete segmentation workflow including:</p><ul>
<li>Configuration of data directories and processing parameters</li>
<li>Loading and preprocessing training data with memory-efficient batching</li>
<li>Training Gaussian Naive Bayes classifier with incremental learning</li>
<li>Testing on validation images with ground truth evaluation</li>
<li>Computing comprehensive metrics (accuracy, Dice, IoU)</li>
<li>Saving visualizations and metric tables for individual images</li>
<li>Generating overall summary statistics across all test images</li>
</ul>
<p>The pipeline uses memory optimization techniques including image resizing, batch processing, and explicit garbage collection to handle large datasets.</p>
<dl class="section return"><dt>Returns</dt><dd>None. All outputs (predictions, metrics, visualizations) are saved to OUTPUT_DIR.</dd></dl>
<pre class="fragment">Memory-efficient main execution pipeline</pre> 
</div>
</div>
<a id="ac6cb2d89b90545261429180549c75224" name="ac6cb2d89b90545261429180549c75224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6cb2d89b90545261429180549c75224">&#9670;&#160;</a></span>predict_segmentation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.predict_segmentation </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>clf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>scaler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>test_image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>use_both_colorspaces</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predict segmentation mask for a test image. </p>
<p>Extracts features from the test image, standardizes them using the fitted scaler, and predicts pixel-wise class labels using the trained Naive Bayes classifier.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clf</td><td>Trained GaussianNB classifier. </td></tr>
    <tr><td class="paramname">scaler</td><td>Fitted StandardScaler for feature normalization. </td></tr>
    <tr><td class="paramname">test_image</td><td>Input test fundus image (BGR format). </td></tr>
    <tr><td class="paramname">use_both_colorspaces</td><td>If True, use both RGB and HSV features. Default is True.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Predicted segmentation mask of shape (height, width) with values in {0, 128, 255}.</dd></dl>
<pre class="fragment">Predict segmentation mask for a test image</pre> 
</div>
</div>
<a id="a9ff8da211c17e9d511aed1aa949134f5" name="a9ff8da211c17e9d511aed1aa949134f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff8da211c17e9d511aed1aa949134f5">&#9670;&#160;</a></span>remap_mask_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.remap_mask_labels </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mask</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remap mask pixel values to standardized label values. </p>
<p>Converts grayscale mask values to exactly three discrete labels based on intensity thresholds. Handles cases where resizing creates intermediate values.</p><ul>
<li>Values 0-63 map to 0 (disc)</li>
<li>Values 64-191 map to 128 (cup)</li>
<li>Values 192-255 map to 255 (background)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Input grayscale mask with arbitrary intensity values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Remapped mask with values in {0, 128, 255}.</dd></dl>
<pre class="fragment">Remap mask values to exactly 0, 128, or 255
Handles cases where resizing creates intermediate values
</pre> 
</div>
</div>
<a id="a13d212ce0288627d6d49c13eddd08478" name="a13d212ce0288627d6d49c13eddd08478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13d212ce0288627d6d49c13eddd08478">&#9670;&#160;</a></span>resize_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.resize_image </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">512</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resize regular fundus image to reduce memory usage. </p>
<p>Proportionally resizes an image so that its largest dimension does not exceed the specified maximum size while maintaining aspect ratio using area interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">image</td><td>Input image array (BGR format). </td></tr>
    <tr><td class="paramname">max_size</td><td>Maximum dimension size in pixels. Default is 512.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Resized image or original image if already within size limit.</dd></dl>
<pre class="fragment">Resize regular image (fundus) to reduce memory usage</pre> 
</div>
</div>
<a id="a9a277730ef50880d2684d3ab72208de5" name="a9a277730ef50880d2684d3ab72208de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a277730ef50880d2684d3ab72208de5">&#9670;&#160;</a></span>resize_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.resize_mask </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">512</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resize segmentation mask using nearest neighbor interpolation. </p>
<p>Resizes a mask image while preserving discrete label values by using nearest neighbor interpolation to avoid creating intermediate values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Input mask array with discrete labels. </td></tr>
    <tr><td class="paramname">max_size</td><td>Maximum dimension size in pixels. Default is 512.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Resized mask or original mask if already within size limit.</dd></dl>
<pre class="fragment">Resize mask using nearest neighbor to preserve discrete labels</pre> 
</div>
</div>
<a id="afe82966cb6078dba455bdd207c50bac0" name="afe82966cb6078dba455bdd207c50bac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe82966cb6078dba455bdd207c50bac0">&#9670;&#160;</a></span>save_metrics_as_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.save_metrics_as_image </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>metrics_dict</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>image_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save evaluation metrics as a formatted table image. </p>
<p>Creates and saves a styled table displaying all evaluation metrics including pixel accuracy, Dice coefficients, and IoU scores for a single test image. The table includes color-coded rows and highlighted mean scores.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics_dict</td><td>Dictionary containing evaluation metrics from evaluate_segmentation(). </td></tr>
    <tr><td class="paramname">image_name</td><td>Name of the image being evaluated (used in title). </td></tr>
    <tr><td class="paramname">save_path</td><td>Full file path where the metrics table image will be saved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. Saves the metrics table as a PNG image to the specified path.</dd></dl>
<pre class="fragment">Save evaluation metrics as a table image

Parameters:
-----------
metrics_dict : dict
    Dictionary containing evaluation metrics
image_name : str
    Name of the image being evaluated
save_path : str
    Full path where to save the metrics image
</pre> 
</div>
</div>
<a id="aa4876264353f0b3bf444e100b7467b62" name="aa4876264353f0b3bf444e100b7467b62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4876264353f0b3bf444e100b7467b62">&#9670;&#160;</a></span>save_summary_metrics_as_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.save_summary_metrics_as_image </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>all_metrics</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save overall summary metrics across all test images as a table image. </p>
<p>Computes mean and standard deviation for all metrics across multiple test images and saves a formatted table displaying the aggregated statistics.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">all_metrics</td><td>List of metrics dictionaries from all test images. Each dictionary should have the same keys as returned by evaluate_segmentation(). </td></tr>
    <tr><td class="paramname">save_path</td><td>Full file path where the summary metrics table image will be saved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. Saves the summary metrics table as a PNG image. Returns early if all_metrics is empty.</dd></dl>
<pre class="fragment">Save overall summary metrics as a table image

Parameters:
-----------
all_metrics : list of dict
    List of metrics dictionaries from all test images
save_path : str
    Path to save the summary image
</pre> 
</div>
</div>
<a id="a8c74781d16d48fbc93bdadc17dc2db3e" name="a8c74781d16d48fbc93bdadc17dc2db3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c74781d16d48fbc93bdadc17dc2db3e">&#9670;&#160;</a></span>train_naive_bayes_memory_efficient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.train_naive_bayes_memory_efficient </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fundus_files</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mask_files</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>use_both_colorspaces</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">512</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Train Naive Bayes classifier using batch processing and incremental learning. </p>
<p>Trains a Gaussian Naive Bayes classifier on fundus images and their segmentation masks using incremental learning with batch processing to reduce memory usage. Uses partial_fit for online learning across batches.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fundus_files</td><td>List of file paths to training fundus images. </td></tr>
    <tr><td class="paramname">mask_files</td><td>List of file paths to corresponding segmentation masks. </td></tr>
    <tr><td class="paramname">use_both_colorspaces</td><td>If True, use both RGB and HSV color spaces. Default is True. </td></tr>
    <tr><td class="paramname">batch_size</td><td>Number of images to process per batch. Default is 5. </td></tr>
    <tr><td class="paramname">max_size</td><td>Maximum image dimension for resizing. Default is 512.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Tuple of (trained_classifier, fitted_scaler) where:<ul>
<li>trained_classifier is a GaussianNB object trained on all batches</li>
<li>fitted_scaler is a StandardScaler for feature normalization</li>
</ul>
</dd></dl>
<pre class="fragment">Memory-efficient training with batching and incremental learning

Parameters:
-----------
fundus_files : list
    List of paths to fundus images
mask_files : list
    List of paths to mask images
use_both_colorspaces : bool
    Whether to use both RGB and HSV features
batch_size : int
    Number of images to process at once
max_size : int
    Maximum image dimension for resizing

Returns:
--------
clf : GaussianNB
    Trained classifier
scaler : StandardScaler
    Fitted feature scaler
</pre> 
</div>
</div>
<a id="a5afa48c6aec410b5355df43bab6e5ec8" name="a5afa48c6aec410b5355df43bab6e5ec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5afa48c6aec410b5355df43bab6e5ec8">&#9670;&#160;</a></span>visualize_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NaiveBayesClassifier.visualize_results </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>original</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>predicted_mask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gt_mask</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_path</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Visualize segmentation results with side-by-side comparison. </p>
<p>Creates a visualization comparing the original image, predicted segmentation mask, and optionally the ground truth mask. Saves the visualization as an image file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original</td><td>Original fundus image (BGR format). </td></tr>
    <tr><td class="paramname">predicted_mask</td><td>Predicted segmentation mask with values {0, 128, 255}. </td></tr>
    <tr><td class="paramname">gt_mask</td><td>Ground truth mask (optional). If provided, creates 3-panel visualization. If None, creates 2-panel visualization. Default is None. </td></tr>
    <tr><td class="paramname">save_path</td><td>File path to save the visualization image. If None, the figure is only closed without saving. Default is None.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. Either saves the visualization to disk or closes the figure.</dd></dl>
<pre class="fragment">Visualize segmentation results</pre> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="_naive_bayes_classifier_8py.html">NaiveBayesClassifier.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
